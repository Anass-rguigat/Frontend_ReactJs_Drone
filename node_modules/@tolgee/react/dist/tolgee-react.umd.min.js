!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("react"),require("@tolgee/web")):"function"==typeof define&&define.amd?define(["exports","react","@tolgee/web"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self)["@tolgee/react"]={},e.React,e["@tolgee/web"])}(this,(function(e,t,n){"use strict";function r(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var s=r(t);function o(e,r,s,o=!0){const[a]=t.useState((()=>{return t=e,Object.assign(Object.assign({},t),{t(...e){const r=n.getTranslateProps(...e);return t.t(Object.assign(Object.assign({},r),{noWrap:!0}))}});var t})),[l,c]=t.useState(o);return t.useEffect((()=>{c(!1)}),[]),t.useMemo((()=>{o&&(e.setEmitterActive(!1),e.addStaticData(s),e.changeLanguage(r),e.setEmitterActive(!0))}),[r,s,e]),t.useState((()=>{if(!e.isLoaded()&&o){const t=e.getRequiredDescriptors(r),n=e.getAllRecords(),s=t.map((({namespace:e,language:t})=>e?`${e}:${t}`:t)).filter((e=>!n.find((t=>(null==t?void 0:t.cacheKey)===e))));console.warn(`Tolgee: Missing records in "staticData" for proper SSR functionality: ${s.map((e=>`"${e}"`)).join(", ")}`)}})),l?a:e}const a={useSuspense:!1};let l;const c=()=>(l||(l=s.default.createContext(void 0)),l);let u;let i;const d=()=>{const e=c(),n=t.useContext(e)||i;if(!n)throw new Error("Couldn't find tolgee instance, did you forgot to use `TolgeeProvider`?");return n},f=()=>{const[e,n]=t.useState(0);return{instance:e,rerender:t.useCallback((()=>{n((e=>e+1))}),[n])}},g=(e,r)=>{const{tolgee:s,options:o}=d(),a=n.getFallback(e),l=n.getFallbackArray(a).join(":"),c=Object.assign(Object.assign({},o),r),{rerender:u,instance:i}=f();t.useRef([]).current=[];const g=s.isLoaded(a);t.useEffect((()=>{const e=s.on("update",u);return()=>{e.unsubscribe()}}),[l,s]),t.useEffect((()=>(s.addActiveNs(a),()=>s.removeActiveNs(a))),[l,s]);const p=t.useCallback((e=>{var t;const n=null!==(t=e.ns)&&void 0!==t?t:null==a?void 0:a[0];return s.t(Object.assign(Object.assign({},e),{ns:n}))}),[s,i]);if(c.useSuspense&&!g)throw s.addActiveNs(a,!0);return{t:p,isLoading:!g}};const p=e=>{if(!e)return;const t={};return Object.entries(e||{}).forEach((([e,n])=>{if("function"==typeof n)t[e]=e=>n(b(e));else if(s.default.isValidElement(n)){const r=n;t[e]=e=>void 0===r.props.children&&(null==e?void 0:e.length)?s.default.cloneElement(r,{},b(e)):s.default.cloneElement(r)}else t[e]=n})),t},b=e=>{const t=(n=e,Array.isArray(n)&&1===n.length?n[0]:n);var n;return Array.isArray(t)?t.map(((e,t)=>s.default.createElement(s.default.Fragment,{key:t},e))):t},m=e=>{const t=e.keyName||e.children;void 0===t&&console.error("T component: keyName not defined");const n=e.defaultValue||(e.keyName?e.children:void 0),r=b(e.t({key:t,params:p(e.params),defaultValue:n,noWrap:e.noWrap,ns:e.ns,language:e.language}));return s.default.createElement(s.default.Fragment,null,r)};e.GlobalContextPlugin=e=>t=>(i={tolgee:t,options:Object.assign(Object.assign({},a),e)},t),e.T=e=>{const{t:t}=g();return s.default.createElement(m,Object.assign({t:t},e))},e.TBase=m,e.TolgeeProvider=({tolgee:e,options:n,children:r,fallback:l,ssr:i})=>{t.useEffect((()=>{(null==u?void 0:u.run)!==e.run&&(u&&u.stop(),u=e,e.run().catch((e=>{console.error(e)})).finally((()=>{b(!1)})))}),[e]);let d=e;const{language:f,staticData:g}="object"!=typeof i?{}:i;d=o(e,f,g,Boolean(i));const[p,b]=t.useState(!d.isLoaded()),m=Object.assign(Object.assign({},a),n),v=c();return m.useSuspense?s.default.createElement(v.Provider,{value:{tolgee:d,options:m}},p?l:s.default.createElement(t.Suspense,{fallback:l||null},r)):s.default.createElement(v.Provider,{value:{tolgee:d,options:m}},p?l:r)},e.getProviderInstance=c,e.useTolgee=e=>{const{tolgee:n}=d(),{rerender:r}=f();return t.useEffect((()=>{const t=null==e?void 0:e.map((e=>n.on(e,r)));return()=>{null==t||t.forEach((e=>e.unsubscribe()))}}),[null==e?void 0:e.join(":")]),n},e.useTolgeeSSR=o,e.useTranslate=(e,r)=>{const{t:s,isLoading:o}=g(e,r);return{t:t.useCallback(((...e)=>{const t=n.getTranslateProps(...e);return s(t)}),[s]),isLoading:o}},Object.keys(n).forEach((function(t){"default"===t||e.hasOwnProperty(t)||Object.defineProperty(e,t,{enumerable:!0,get:function(){return n[t]}})})),Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=tolgee-react.umd.min.js.map
